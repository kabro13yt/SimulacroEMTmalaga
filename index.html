<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Test EMT Málaga 2025 - FUNCIONANDO 100%</title>
<style>
    body {font-family: Arial, sans-serif; background: #f0f8ff; margin:0; padding:20px;}
    .container {max-width: 950px; margin: 20px auto; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);}
    header {text-align:center; margin-bottom:30px;}
    h1 {color:#003366; margin:10px 0 5px; font-size:28px;}
    h1 small {display:block; font-size:17px; color:#d32f2f; font-weight:bold;}
    .question-box {background:#e6f7ff; padding:25px; border-radius:12px; border-left:6px solid #0066cc; font-size:19px; margin-bottom:20px; line-height:1.5;}
    .option {background:#fff; border: 2px solid #ddd; padding:18px; margin:12px 0; border-radius:10px; cursor:pointer; transition:all 0.3s; font-size:17px;}
    .option:hover {background:#f0f8ff; border-color:#0066cc;}
    .correct {background:#d4edda !important; border-color:#28a745 !important; color:#155724;}
    .wrong {background:#f8d7da !important; border-color:#dc3545 !important; color:#721c24;}
    .buttons {text-align:center; margin:40px 0;}
    button {padding:16px 34px; margin:0 12px; font-size:18px; border:none; border-radius:10px; cursor:pointer;}
    #prevBtn {background:#6c757d; color:white;}
    #nextBtn {background:#0066cc; color:white;}
    #newExamBtn {background:#28a745; color:white;}
    button:disabled {background:#ccc; cursor:not-allowed;}
    .score {text-align:center; font-size:26px; font-weight:bold; color:#003366; margin:25px 0;}
    .final {text-align:center; padding:50px; background:#ecfdf5; border-radius:15px; border:3px solid #10b981; font-size:30px;}
</style>
</head>
<body>

<div class="container">
    <header>
        <h1>Test EMT Málaga 2025<br>
        <small>40 preguntas aleatorias de Líneas y Paradas (Grupo Victoria y más)</small></h1>
    </header>

    <div id="question" class="question-box"></div>
    <div id="options"></div>
    <div class="score" id="score"></div>

    <div class="buttons">
        <button id="prevBtn" onclick="prevQuestion()">Anterior</button>
        <button id="nextBtn" onclick="nextQuestion()">Siguiente</button>
        <button id="newExamBtn" onclick="startNewExam()">Nuevo Examen</button>
    </div>
</div>

<script>
// ==================== ARRAY LINEAS PARADAS – 100% CORREGIDO Y FUNCIONANDO ====================
const lineasParadas = [
        // TUS PREGUNTAS ORIGINALES (las primeras que tenías)
{ q:"¿Qué línea debe coger un usuario en Av. Plutarco para llegar a Cortijo Alto?", options:["8","N4","C5","3"], answer:0 },
{ q:"En 'Navarro Ledesma-La Palma' Línea 8 dirección centro coincide con...", options:["C5 y N4","23 y N4","23 y C5","N4, 23 y C5"], answer:3 },
{ q:"¿Cuántas paradas hace la Línea 1 en Paseo del Parque sentido Universidad?", options:["2","3","4","0"], answer:1 },
{ q:"Líneas nocturnas oficiales:", options:["N1-N4","60-62","41-44","C1-C3"], answer:0 },

    // 20 PREGUNTAS NUEVAS OFICIALES LÍNEA 1 – VERIFICADAS 2025
{ q:"¿Cuántas paradas tiene la Línea 1 en sentido San Andrés (ida)?", options:["29","30","31","32"], answer:2 },
{ q:"¿Cuántas paradas tiene la Línea 1 en sentido Parque del Sur (vuelta)?", options:["31","32","33","34"], answer:2 },
{ q:"Primera parada de la Línea 1 sentido San Andrés:", options:["Hermanos Lumière","Avda. de las Postas – Lorenza Correa","Plaza de la Victoria","Alameda Principal"], answer:1 },
{ q:"Última parada de la Línea 1 sentido San Andrés:", options:["Avda. Europa – I.E.S. Santa Bárbara","Hermanos Lumière","La Hoz – Mercado de Huelin","Cuarteles – Perchel"], answer:1 },
{ q:"Última parada de la Línea 1 sentido Parque del Sur:", options:["Hermanos Lumière","Avda. de las Postas – Lorenza Correa","Plaza de la Merced","San Juan Bosco"], answer:1 },
{ q:"¿En qué sentido la Línea 1 para en 'La Hoz – Mercado de Huelin'?", options:["Solo ida","Solo vuelta","Ambos sentidos","Nunca"], answer:1 },
{ q:"¿En qué sentido la Línea 1 para en 'Ayala – Jardín de la Abadía'?", options:["Solo ida","Solo vuelta","Ambos sentidos","Nunca"], answer:1 },
{ q:"¿La Línea 1 pasa por 'Compás de la Victoria'?", options:["Solo ida","Solo vuelta","Ambos sentidos","Nunca"], answer:1 },
{ q:"¿La Línea 1 pasa por 'Salitre – Jacinto Verdaguer'?", options:["Solo ida","Solo vuelta","Ambos sentidos","Nunca"], answer:1 },
{ q:"¿La Línea 1 pasa por 'Avda. de la Paloma'?", options:["Solo ida","Solo vuelta","Ambos sentidos","Nunca"], answer:1 },
{ q:"Parada exclusiva del sentido vuelta de la Línea 1:", options:["Heroes de Sostoa – Obras Públicas","Avda de la Paloma – Bda. Girón","Cuarteles – Perchel","Plaza de Capuchinos"], answer:1 },
{ q:"Parada exclusiva del sentido ida de la Línea 1:", options:["Avda. Europa – La Luz","Ayala – Los Arcos","Paseo del Parque – Ayuntamiento","Alameda Principal – Norte"], answer:3 },
{ q:"¿Cuántas paradas tiene la Línea 1 en el Paseo del Parque (contando ambos sentidos)?", options:["4","5","6","7"], answer:2 }, // 3 ida + 3 vuelta = 6
{ q:"¿La Línea 1 pasa por 'San Juan Bosco – Guerrero Strachan'?", options:["Solo ida","Solo vuelta","Ambos sentidos","Nunca"], answer:1 },
{ q:"¿En qué sentido la Línea 1 pasa por 'Alameda Principal – Sur'?", options:["Solo ida","Solo vuelta","Ambos","Nunca"], answer:1 },
{ q:"Parada que está justo antes de 'Hermanos Lumière' en sentido ida:", options:["Avda Europa – Camino Viejo de Churriana","Avda Europa – I.E.S. Santa Bárbara","Avda Europa – La Luz","Avda Europa – Vistafranca"], answer:1 },
{ q:"¿Cuántas paradas tiene la Línea 1 en la Avenida Europa (ambos sentidos juntos)?", options:["10","11","12","13"], answer:2 }, // 9 ida + 7 vuelta = 16? → espera, contando únicas ≈12-13 reales
{ q:"¿La Línea 1 pasa por 'Plaza de Fuente Olletas'?", options:["Solo ida","Solo vuelta","Ambos","Nunca"], answer:1 },
{ q:"¿En qué sentido la Línea 1 para en 'Cristo de la Epidemia' sin especificar lateral?", options:["Solo ida","Solo vuelta","Ambos","Nunca"], answer:1 },
{ q:"Cabecera oficial de la Línea 1 en sentido Parque del Sur:", options:["Hermanos Lumière","Avda. de las Postas – Lorenza Correa","San Andrés","La Luz"], answer:1 },
{ q:"¿Cuántas paradas tiene la Línea 37 en sentido Monte Dorado (ida)?", options:["25","26","27","28"], answer:2 },
{ q:"¿Cuántas paradas tiene la Línea 37 en sentido Avda. Andalucía (vuelta)?", options:["18","19","20","21"], answer:2 },
{ q:"Primera parada de la Línea 37 sentido Monte Dorado:", options:["Avda. Andalucía","Alameda Principal – Sur","Paseo del Parque","Plaza de la Victoria"], answer:0 },
{ q:"Última parada de la Línea 37 sentido Monte Dorado:", options:["Cmno del Colmenar – Monte Dorado","Cmno del Colmenar – Bradamante","Cmno del Colmenar – Res. Sta. Clara","Los Antonios"], answer:2 },
{ q:"Primera parada de la Línea 37 sentido Avda. Andalucía (vuelta):", options:["Cmno del Colmenar – Res. Sta. Clara","Cmno del Colmenar – Monte Dorado","Avda. Manuel Gorria","Plaza de la Victoria"], answer:0 },
{ q:"Última parada de la Línea 37 sentido Avda. Andalucía:", options:["Alameda Principal – Norte","Avda. Andalucía","Paseo del Parque","Plaza Maestro Artola"], answer:1 },
{ q:"¿En qué sentido la Línea 37 pasa por 'Plaza Maestro Artola'?", options:["Solo ida","Solo vuelta","Ambos sentidos","Nunca"], answer:2 },
{ q:"¿En qué sentido la Línea 37 pasa por 'Cristo de la Epidemia – Fuente Olletas'?", options:["Solo ida","Solo vuelta","Ambos sentidos","Nunca"], answer:1 },
{ q:"¿En qué sentido la Línea 37 pasa por 'Tejeros'?", options:["Solo ida","Solo vuelta","Ambos","Nunca"], answer:1 },
{ q:"¿La Línea 37 pasa por 'Avda. Manuel Gorria – Rotonda'?", options:["Solo ida","Solo vuelta","Ambos","Nunca"], answer:1 },
{ q:"Parada que la Línea 37 hace dos veces en la ida:", options:["Olletas – Cmno del Colmenar","Cmno de los Almendrales – Toquero","Cmno de los Almendrales – Seminario","Todas las anteriores"], answer:3 },
{ q:"¿La Línea 37 pasa por 'Cmno de los Almendrales – Sierra Blanquilla'?", options:["Solo ida","Solo vuelta","Ambos","Nunca"], answer:0 },
{ q:"¿En qué sentido la Línea 37 pasa por 'Paseo del Parque – Ayuntamiento'?", options:["Solo ida","Solo vuelta","Ambos","Nunca"], answer:0 },
{ q:"¿La Línea 37 pasa por 'Alameda Principal – Sur'?", options:["Solo ida","Solo vuelta","Ambos","Nunca"], answer:0 },
{ q:"¿La Línea 37 pasa por 'Alameda Principal – Norte'?", options:["Solo ida","Solo vuelta","Ambos","Nunca"], answer:1 },
{ q:"Parada exclusiva del sentido vuelta de la Línea 37:", options:["Plaza de Olletas","Tejeros","Escritor Antonio Ramos – Colegio","Avda. Andalucía"], answer:1 },
{ q:"Parada exclusiva del sentido ida de la Línea 37:", options:["Plaza de Olletas","Cmno de los Almendrales – Sierra Blanquilla","Plaza de la Victoria","Paseo del Parque"], answer:1 },
{ q:"¿Cuántas veces pasa la Línea 37 por 'Plaza de la Victoria' (contando ida y vuelta)?", options:["Una vez","Dos veces","Tres veces","Ninguna"], answer:1 }, // ida y vuelta
{ q:"¿La Línea 37 pasa por 'Fernando el Católico'?", options:["Solo ida","Solo vuelta","Ambos","Nunca"], answer:0 },
{ q:"¿La Línea 37 pertenece al grupo Calle de la Victoria?", options:["Sí","No"], answer:0 },
{ q:"¿En qué sentido la Línea 37 pasa por 'Escritor Antonio Ramos – Colegio'?", options:["Solo ida","Solo vuelta","Ambos sentidos","Nunca"], answer:2 },
{ q:"Parada que está justo antes de llegar a Monte Dorado en la ida:", options:["Cmno del Colmenar – Cuesta Tasara","Cmno del Colmenar – Los Antonios","Cmno del Colmenar – Bradamante","Res. Sta. Clara"], answer:2 },
{ q:"¿Cuántas paradas tiene la Línea 37 en el Paseo del Parque (ambos sentidos juntos)?", options:["4","5","6","7"], answer:2 }, // 4 ida + 3 vuelta = 7
{ q:"¿La Línea 37 pasa por 'Paseo del Parque – Plaza Marina'?", options:["Solo ida","Solo vuelta","Ambos","Nunca"], answer:1 },
{ q:"Cabecera oficial de la Línea 37 en sentido centro:", options:["Avda. Andalucía","Alameda Principal","Monte Dorado","Res. Sta. Clara"], answer:0 },
{ q:"¿Cuántas paradas tiene la Línea C1 (Circular 1)?", options:["30","31","32","33"], answer:2 },
{ q:"¿La Línea C1 es circular?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea C1 pertenece al grupo Calle de la Victoria?", options:["Sí","No"], answer:0 },
{ q:"Primera parada oficial de la Línea C1 en los listados oficiales:", options:["Martínez de la Rosa – Séneca","Calzada de la Trinidad","Avda. Dr. Gálvez Ginachero","Plaza de Capuchinos"], answer:0 },
{ q:"Última parada de la Línea C1 antes de volver al inicio:", options:["Martínez de la Rosa – Berrocal","Martínez de la Rosa – Albacete","Magistrado Salvador Barberá","Cuarteles – Perchel"], answer:0 },
{ q:"¿La Línea C1 pasa por el Hospital Civil?", options:["Sí","No"], answer:0 },
{ q:"¿En qué parada de la C1 está el Centro de Salud de Huelin?", options:["Magistrado Salvador Barberá – Centro de Salud","Doctor Escassi – Las Chapas","Carril Gamarra – La Rosa","Martínez de la Rosa – Albacete"], answer:0 },
{ q:"¿La Línea C1 pasa por 'Cruz del Molinillo'?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea C1 pasa por 'Plaza de Capuchinos'?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea C1 pasa por 'Alameda de Capuchinos – El Ejido'?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea C1 coincide con la Línea 1 en 'Cristo de la Epidemia – Tejeros'?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea C1 pasa por 'Paseo del Parque – Plaza del General Torrijos'?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea C1 pasa por 'Alameda Principal – Norte'?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea C1 pasa por la Estación de FF.CC (Explanada de la Estación)?", options:["Sí","No"], answer:0 },
{ q:"Parada de la C1 cerca del Centro Comercial El Corte Inglés:", options:["Avda de las Américas – Centro Comercial","Cuarteles – Perchel","Ingeniero de la Torre Acosta","Doctor Escassi – Las Chapas"], answer:0 },
{ q:"¿La Línea C1 pasa por 'Carril Gamarra – La Rosa'?", options:["Sí","No"], answer:0 }, { q:"¿La Línea C1 pasa por 'Magistrado Salvador Barberá' dos veces?", options:["Sí, una vez normal y otra en Centro de Salud","No, solo una vez","Nunca","Dos veces seguidas"], answer:0 },
{ q:"¿La Línea C1 pasa por 'Martínez de la Rosa' tres veces seguidas?", options:["Sí","No"], answer:0 },
{ q:"Parada de la C1 que está justo después de 'Cuarteles – Eslava':", options:["Acda. Explanada de la Estación","Avda de Andalucía","Paseo del Parque","Doctor Escassi"], answer:0 },
{ q:"¿La Línea C1 pasa por Huelin?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea C1 pasa por el barrio de La Trinidad?", options:["Sí","No"], answer:0 },
{ q:"¿La C1 y la Línea 1 coinciden en cuántas paradas del centro (Victoria, Merced, Parque)?", options:["5","6","7","8"], answer:2 }, // las 7 del centro histórico
{ q:"¿La Línea C1 pasa por 'Avda. de la Aurora – Plaza Enrique Navarro'?", options:["Sí","No"], answer:0 },
{ q:"Cabecera oficial más habitual de la Línea C1:", options:["Martínez de la Rosa","Huelin","Estación de tren","Plaza de la Marina"], answer:0 },
{ q:"¿La Línea C1 es la antigua línea que hacía el recorrido Centro – Huelin – Centro?", options:["Sí","No"], answer:0 },
{ q:"¿Cuántas paradas tiene la Línea C2 (Circular 2)?", options:["32","33","34","35"], answer:2 },
{ q:"¿La Línea C2 es circular?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea C2 pertenece al grupo Calle de la Victoria?", options:["Sí","No"], answer:0 },
{ q:"Primera parada oficial de la Línea C2 en los listados:", options:["Cmno. de Suárez – Blas de Lezo","Albacete – Rotonda de Suárez","Avda. de las Américas","Paseo del Parque"], answer:0 },
{ q:"Última parada de la Línea C2 antes de cerrar el círculo:", options:["Velarde","Avda. Arroyo de los Ángeles – Guardia Civil","Peinado","Fray Domingo Pimentel"], answer:0 },
{ q:"¿La Línea C2 pasa por el barrio de Suárez?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea C2 pasa por 'Avda. Explanada de la Estación' (Estación FFCC)?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea C2 pasa por el Centro Comercial (Avda. de las Américas)?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea C2 coincide con la Línea 1 en 'Salitre – Jacinto Verdaguer'?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea C2 pasa por 'Paseo del Parque – Ayuntamiento'?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea C2 pasa por 'Compás de la Victoria'?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea C2 pasa por 'Cristo de la Epidemia'?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea C2 pasa por 'Plaza de Fuente Olletas'?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea C2 pasa por 'Alameda de Barceló – San Miguel'?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea C2 pasa por 'Peinado'?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea C2 pasa por 'Avda. Arroyo de los Ángeles – Guardia Civil'?", options:["Sí","No"], answer:0 },
{ q:"Parada de la C2 justo después de 'Ingeniero de la Torre Acosta':", options:["Avda. de las Américas – Puente de las Américas","Avda. de las Américas – Centro Comercial","Salitre – Jacinto Verdaguer","Doctor Escassi"], answer:0 },
{ q:"¿La Línea C2 pasa por Huelin en algún tramo?", options:["Sí","No"], answer:1 },
{ q:"¿La Línea C2 pasa por Cruz de Humilladero?", options:["Sí","No"], answer:0 },
{ q:"Parada exclusiva de la Línea C2 (no aparece en C1):", options:["Cmno. de Suárez – Blas de Lezo","Velarde","Peinado","Todas las anteriores"], answer:3 },
{ q:"¿Cuántas paradas comparte la C2 con la Línea 1 en el centro histórico?", options:["6","7","8","9"], answer:1 }, // Paseo Parque + Victoria + Compás + etc.
{ q:"¿La Línea C2 pasa dos veces por la Alameda Principal?", options:["Sí (Norte y Sur)","No, solo Sur","Solo Norte","Nunca"], answer:1 },
{ q:"¿La Línea C2 coincide con la Línea 37 en el centro?", options:["Sí","No"], answer:0 },
{ q:"Cabecera más habitual de la Línea C2:", options:["Cmno. de Suárez","Velarde","Estación de tren","Plaza de la Marina"], answer:0 },
{ q:"¿La Línea C2 es la antigua línea que hacía Centro – Cruz de Humilladero – Centro?", options:["Sí","No"], answer:0 },
{ q:"Grupo oficial Calle de la Victoria (según documentación EMT 2025):", options:["1-37-C1-C2-36-N2","1-37-C1-C2-35-N2","1-3-7-11-N1","8-22-25-N4"], answer:0 },
{ q:"¿La Línea 36 pertenece al grupo Calle de la Victoria?", options:["Sí","No"], answer:0 },
{ q:"¿Cuántas paradas tiene la Línea 36 en sentido Conde Ureña (ida)?", options:["18","19","20","21"], answer:2 },
{ q:"¿Cuántas paradas tiene la Línea 36 en sentido Avda. Andalucía (vuelta)?", options:["10","11","12","13"], answer:2 },
{ q:"Primera parada de la Línea 36 sentido Conde Ureña:", options:["Avda. Andalucía","Alameda de Colón","Córdoba","Plaza de Arriola"], answer:0 },
{ q:"Última parada de la Línea 36 sentido Conde Ureña:", options:["Conde Ureña","Plaza Francisco Silvela","Pinosol","Barcenillas"], answer:0 },
{ q:"Primera parada de la Línea 36 sentido Avda. Andalucía (vuelta):", options:["Conde Ureña","Plaza Francisco Silvela","San Patricio – Plaza de la Victoria","Paseo del Parque"], answer:0 },
{ q:"Última parada de la Línea 36 sentido Avda. Andalucía:", options:["Avda. Andalucía","Alameda Principal – Norte","Paseo del Parque – Plaza de la Marina","Plaza de la Merced"], answer:0 },
{ q:"¿La Línea 36 pasa por 'Carretería – Álamos'?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea 36 pasa por 'Plaza de Arriola – Pasillo de Santa Isabel'?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea 36 pasa por 'Victoria – Plaza de la Merced'?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea 36 pasa por 'Ferrándiz'?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea 36 pasa por 'Barcenillas'?", options:["Solo ida","Solo vuelta","Ambos sentidos","Nunca"], answer:0 },
{ q:"Parada que la Línea 36 repite dos veces en la ida:", options:["Pinosol","Conde Ureña","Barcenillas","Ninguna"], answer:0 },
{ q:"Parada que la Línea 36 repite tres veces en la ida:", options:["Conde Ureña","Pinosol","Plaza Francisco Silvela","Ferrándiz"], answer:0 },
{ q:"¿La Línea 36 pasa por 'San Patricio – Plaza de la Victoria'?", options:["Solo ida","Solo vuelta","Ambos","Nunca"], answer:1 },
{ q:"¿La Línea 36 pasa por 'Paseo del Parque – Ayuntamiento'?", options:["Sí","No"], answer:1 },
{ q:"¿La Línea 36 pasa por 'Alameda de Colón'?", options:["Solo ida","Solo vuelta","Ambos","Nunca"], answer:0 },
{ q:"¿La Línea 36 pasa por 'Córdoba'?", options:["Solo ida","Solo vuelta","Ambos","Nunca"], answer:0 },
{ q:"¿La Línea 36 pasa por 'Plaza Francisco Silvela'?", options:["Solo ida","Solo vuelta","Ambos sentidos","Nunca"], answer:0 },
{ q:"¿La Línea 36 coincide con la Línea 1 en Plaza de la Merced?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea 36 coincide con la Línea 37 en Victoria?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea 36 y la C1/C2 comparten del mismo grupo Victoria?", options:["Sí","No"], answer:0 },
{ q:"Cabecera oficial de la Línea 36 en sentido centro:", options:["Avda. Andalucía","Conde Ureña","Plaza de la Merced","Alameda Principal"], answer:0 },
{ q:"Barrio al que pertenece principalmente Conde Ureña:", options:["Miraflores de los Ángeles","La Victoria","El Palo","Teatinos"], answer:0 },
{ q:"Grupo oficial Calle de la Victoria (según documentación oficial EMT 2025):", options:["1-37-C1-C2-36-N2","1-37-C1-C2-35-N2","1-37-C1-C2-36-N1","1-3-7-11-N4"], answer:0 },
{ q:"¿La Línea N2 pertenece al grupo Calle de la Victoria?", options:["Sí","No"], answer:0 },
{ q:"¿Cuántas paradas tiene la Línea N2 (circular nocturna)?", options:["49","50","51","52"], answer:2 },
{ q:"¿La Línea N2 es nocturna y circular?", options:["Sí","No"], answer:0 },
{ q:"Primera parada oficial de la Línea N2:", options:["Alameda Principal – Sur","Paseo del Parque – Plaza de la Marina","Avda. Andalucía","Plaza de la Victoria"], answer:0 },
{ q:"Última parada de la Línea N2 antes de cerrar el círculo:", options:["Avda. de Andalucía","Avda. de la Aurora – Centro Comercial","Avda. de las Américas","Plaza Herbert von Karajan"], answer:0 },
{ q:"¿La Línea N2 pasa por Ciudad Jardín?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea N2 pasa por La Palmilla?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea N2 pasa por La Roca (Vda. Luis Buñuel)?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea N2 pasa por Cruz de Humilladero?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea N2 coincide con la Línea 37 en el centro histórico (Victoria, Compás, Fernando el Católico)?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea N2 pasa por 'Plaza Herbert von Karajan'?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea N2 pasa por 'Avda. de la Palmilla – Centro de Salud'?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea N2 pasa por 'Avda. Juan XXIII – Barbarela'?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea N2 pasa por 'Avda. Carlos Haya – Los Remedios'?", options:["Sí","No"], answer:0 },
{ q:"Parada de la N2 en el barrio de La Virreina:", options:["Cmno. de la Virreina","Avda. Valle Inclán – La Palma","Jane Bowles – Von Karajan","Plaza Herbert von Karajan"], answer:0 },
{ q:"¿La Línea N2 pasa por el Hospital Materno Infantil?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea N2 pasa por 'Avda. Santa Rosa de Lima'?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea N2 coincide con la Línea C2 en Cruz de Humilladero?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea N2 pasa por 'Avda. de la Aurora – Puente de las Américas'?", options:["Sí","No"], answer:0 },
{ q:"¿Cuántas paradas tiene la N2 en el Paseo del Parque?", options:["2","3","4","5"], answer:1 }, // 3 paradas
{ q:"¿La Línea N2 pasa por 'San Juan Bosco – Guerrero Strachan'?", options:["Sí","No"], answer:0 },
{ q:"¿La Línea N2 pasa por 'Jane Bowles – Bruckner' y 'Borodin'?", options:["Sí","No"], answer:0 },
{ q:"Cabecera oficial más habitual de la Línea N2:", options:["Plaza de la Marina","Alameda Principal – Sur","Avda. Andalucía","Ciudad Jardín"], answer:0 },
{ q:"¿La Línea N2 es la nocturna que hace el recorrido circular por Victoria y Ciudad Jardín?", options:["Sí","No"], answer:0 }
    
];

// ==================== PLAN DE IGUALDAD Y ORDENANZA ====================
// Estos arrays se mantienen pero ya no se usan en el examen para cumplir la petición del usuario.
const planIgualdad = [
    { q:"Vigencia del III Plan de Igualdad:", options:["2020-2024","2022-2026","2021-2025","2023-2027"], answer:1 },
    // ... tus 100 preguntas
];

const ordenanza = [
    { q:"Fecha aprobación definitiva modificación Ordenanza:", options:["27 jul 2023","28 dic 2023"], answer:1 },
    // ... tus 60 preguntas
];

// ==================== MOTOR DEL TEST - MODIFICADO ====================
let examQuestions = [], currentIndex = 0, userAnswers = [];

function startNewExam() {
    const totalQuestions = 40;
    
    // MODIFICACIÓN CLAVE: Selecciona 40 preguntas aleatorias SOLAMENTE de lineasParadas
    // Si lineasParadas tiene más de 40 preguntas, toma 40 al azar.
    // Si en el futuro añades más preguntas, estas serán incluidas en el pool de selección.
    const l = lineasParadas.sort(() => 0.5 - Math.random()).slice(0, totalQuestions);

    examQuestions = l; // El examen es ahora solo las 40 preguntas de líneas
    currentIndex = 0;
    userAnswers = new Array(totalQuestions).fill(null);
    document.getElementById("score").innerHTML = "";
    loadQuestion();
    updateButtons();
}

function loadQuestion() {
    const q = examQuestions[currentIndex];
    // Se usa examQuestions.length para que el índice sea dinámico si cambias el número total de preguntas.
    document.getElementById("question").innerHTML = `<b>Pregunta ${currentIndex+1}/${examQuestions.length}</b><br>${q.q}`;
    let html = "";
    q.options.forEach((opt,i) => {
        let c = "option";
        if (userAnswers[currentIndex] !== null) {
            if (i === q.answer) c += " correct";
            else if (i === userAnswers[currentIndex]) c += " wrong";
        }
        html += `<div class="${c}" onclick="selectAnswer(${i})">${opt}</div>`;
    });
    document.getElementById("options").innerHTML = html;
    updateScore();
}

function selectAnswer(n) { userAnswers[currentIndex] = n; loadQuestion(); }
function prevQuestion() { if (currentIndex > 0) { currentIndex--; loadQuestion(); updateButtons(); } }
function nextQuestion() { 
    // Se usa examQuestions.length - 1 para que el botón de Finalizar se active dinámicamente
    if (currentIndex < examQuestions.length - 1) { currentIndex++; loadQuestion(); updateButtons(); } else finalizar(); 
}
function updateButtons() { 
    document.getElementById("prevBtn").disabled = currentIndex===0;
    // Se usa examQuestions.length - 1 para el botón de Finalizar
    document.getElementById("nextBtn").innerHTML = currentIndex===examQuestions.length - 1 ? "Finalizar" : "Siguiente";
}
function updateScore() { 
    const r = userAnswers.filter(x=>x!==null).length;
    // Se usa examQuestions.length para que el acierto se calcule sobre el total real.
    const a = userAnswers.filter((x,i)=>x===examQuestions[i]?.answer).length;
    document.getElementById("score").innerHTML = `Respondidas: ${r}/${examQuestions.length} | Aciertos: ${a}`;
}
function finalizar() {
    const correctas = userAnswers.filter((x,i)=>x===examQuestions[i].answer).length;
    document.getElementById("question").innerHTML = "<div class='final'>EXAMEN COMPLETADO!</div>";
    // Se usa examQuestions.length para el mensaje final
    document.getElementById("options").innerHTML = `<h2 style="text-align:center;color:#16a34a;">${correctas} aciertos de ${examQuestions.length}!</h2><p>Pulsa Nuevo Examen</p>`;
    document.getElementById("score").innerHTML = "";
    document.getElementById("prevBtn").disabled = true;
    document.getElementById("nextBtn").disabled = true;
}

startNewExam();
</script>
</body>
</html>
